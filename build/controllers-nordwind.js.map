{"version":3,"sources":["controllers-nordwind.js"],"names":["r","e","n","t","o","i","f","c","require","u","a","Error","code","p","exports","call","length","1","module","angular","run","$rootScope","redirect","backend","$on","href","location","split","route","pnr","lastName","decodeURIComponent","searchOrder","then","resp","goToAddServices","./screens/add-services/AddServicesScreenController","./screens/search-order/search-order","2","controller","$scope","$routeParams","$window","utils","fancyboxTools","submitPayment","removeInsuranceAeroexpress","vm","agree","modifyServicesLoading","orderServicesLoading","selectedPaymentForm","selectedPaymentType","submitPaymentConfirm","showNeedSelectPaymentFormMesage","email","phone","confirmLoading","confirmError","startPaymentForExtraServices","card","goToConfirmOrder","eraseAeroexpressBecauseOfCurrency","eraseInsuranceBecauseOfCurrency","openHandler","mode","submitCallback","removedSvcs","closeCallback","updateOrderServices","svcsToIssue","noExtraServicesLeft","disableOutsideCloseClick","error","fatalError","paymentFormChangeHandler","reloadPage","reload","clearSession","goToSearchOrder","swithcSubmitButtonHoverState","submitButtonHover","this","loading","searchOrderLoading","openOrder","event","data","ready","element","text","getAliasWithPrefix","clearOrderInfoListeners","clearUpdateOrderServicesListeners","addOrderInfoListener","orderInfo","addUpdateOrderServicesListener","priceVariant","isFreePricevariant","es","reformatAvailableExtraServices","esList","getAvailableExtraServicesList","getParam","hasBonusCard","ffpSumm","ffpBonus","total","errorMessage","switchDefaultSelectedServices","addExtraServiceListener","state","addExtraServiceErrorListener","req","modifyServicesError","3","SearchOrderScreenController","$timeout","clear","clearOrderInfo","showSearchForm","partiallyAddedPassengers","submitSearch","submitTouched","searchOrderAgree","searchOrderForm","$valid","searchLoading","searchOrderByParams","searchParams","flight","date","needToSpecifyDocument","orderCompletelyInitialized","updateOrderInfoHandler","errorHandler","updateOrderInfo","passengers","confirmHandler","finishSeparatePassengersSearch","addPassenger","passengerLastNameRegexp","applicationConstants","pnrOrTicketRegexp","ticketRegexp","pnrOrTicketNumber"],"mappings":"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","file":"controllers-nordwind.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){\n\"use strict\";\nrequire('./screens/add-services/AddServicesScreenController');\nrequire('./screens/search-order/search-order');\n\nangular.module('app').run(['$rootScope', 'redirect', 'backend', function ($rootScope, redirect, backend) {\n    $rootScope.$on('$locationChangeStart', function (e) {\n\n        var href = location.href.split('#')[1];\n\n        href = href.split('/');\n\n        var route = href[1],\n            pnr = href[2],\n            lastName = href[3];\n\n\n        if (route === 'add-services' && pnr && lastName) {\n            lastName = decodeURIComponent(lastName);\n\n            backend.searchOrder(pnr, lastName).then(function (resp) {\n                redirect.goToAddServices();\n            });\n\n        }\n\n    })\n}]);\n\n},{\"./screens/add-services/AddServicesScreenController\":2,\"./screens/search-order/search-order\":3}],2:[function(require,module,exports){\n\"use strict\";\n'use strict';\n\nangular.module('app').controller('AddServicesScreenController', ['$scope', '$routeParams', '$window', 'redirect', 'backend', 'utils', 'fancyboxTools', function ($scope, $routeParams, $window, redirect, backend, utils, fancyboxTools) {\n    var vm = this;\n\n    vm.loading = true;\n    vm.searchOrderLoading = true;\n    vm.orderServicesLoading = true;\n\n    vm.openOrder = redirect.goToSearchOrder;\n    vm.submitPayment = submitPayment;\n    vm.paymentFormChangeHandler = paymentFormChangeHandler;\n    vm.reloadPage = reloadPage;\n    vm.clearSession = clearSession;\n    vm.swithcSubmitButtonHoverState = swithcSubmitButtonHoverState;\n\n    $scope.$on('plasticCardForPaymentChangeEvent', function (event, data) {\n        vm.card = data;\n    });\n\n    backend.ready.then(function () {\n        angular.element('title').text(backend.getAliasWithPrefix('web.pageTitle.', 'addServices'));\n\n        vm.loading = false;\n\n        backend.clearOrderInfoListeners();\n        backend.clearUpdateOrderServicesListeners();\n\n        backend.addOrderInfoListener(function (orderInfo) {\n            vm.orderInfo = orderInfo;\n        });\n\n        backend.addUpdateOrderServicesListener(function (resp) {\n            vm.orderInfo = resp[1];\n            vm.priceVariant = resp[2];\n            vm.isFreePricevariant = utils.isFreePricevariant(resp[2]);\n\n            if (vm.isFreePricevariant) {\n                vm.showNeedSelectPaymentFormMesage = false;\n            }\n\n            vm.es = utils.reformatAvailableExtraServices(resp[0], vm.orderInfo, vm.es);\n            vm.esList = utils.getAvailableExtraServicesList(resp[0], vm.es);\n\n            vm.searchOrderLoading = false;\n            vm.orderServicesLoading = false;\n\n            if (backend.getParam('ffp.enable') && (vm.orderInfo.hasBonusCard || vm.orderInfo.ffpSumm)) {\n                backend.ffpBonus().then(function (resp) {\n                    vm.ffpBonus = resp.total || 0;\n                });\n            }\n        }, function (resp) {\n            vm.searchOrderLoading = false;\n            vm.orderServicesLoading = false;\n            vm.errorMessage = resp.error;\n        });\n\n        backend.updateOrderServices(true).then(function () {\n            vm.loading = true;\n\n            backend.switchDefaultSelectedServices(vm.esList, vm.es, vm.orderInfo).then(function () {\n                vm.loading = false;\n            }, function (resp) {\n                vm.errorMessage = resp.error;\n                vm.loading = false;\n            });\n        });\n\n        backend.addExtraServiceListener(function (state) {\n            vm.modifyServicesLoading = !state;\n            vm.orderServicesLoading = true;\n        });\n\n        backend.addExtraServiceErrorListener(function (resp, req) {\n            if (!req || req.code !== 'seat') {\n                vm.modifyServicesError = resp.error;\n            }\n\n            vm.modifyServicesLoading = false;\n            vm.orderServicesLoading = true;\n        });\n    });\n\n    function submitPayment(removeInsuranceAeroexpress) {\n        if (vm.agree && !vm.modifyServicesLoading && !vm.orderServicesLoading) {\n            if (vm.selectedPaymentForm && vm.selectedPaymentType) {\n                submitPaymentConfirm(removeInsuranceAeroexpress);\n            } else {\n                vm.showNeedSelectPaymentFormMesage = true;\n            }\n        }\n    }\n\n    function submitPaymentConfirm(removeInsuranceAeroexpress, email, phone) {\n        vm.confirmLoading = true;\n\n        if (vm.confirmError) {\n            delete vm.confirmError;\n        }\n\n        backend.startPaymentForExtraServices(vm.selectedPaymentForm, vm.selectedPaymentType, removeInsuranceAeroexpress, email, phone, vm.card).then(function (resp) {\n            if (resp.pnr && resp.lastName) {\n                redirect.goToConfirmOrder();\n            } else if (resp.eraseAeroexpressBecauseOfCurrency || resp.eraseInsuranceBecauseOfCurrency) {\n                fancyboxTools.openHandler('popupChangeCurrencyError', false, {\n                    eraseAeroexpressBecauseOfCurrency: resp.eraseAeroexpressBecauseOfCurrency,\n                    eraseInsuranceBecauseOfCurrency: resp.eraseInsuranceBecauseOfCurrency,\n                    mode: 'addServices',\n                    submitCallback: submitPayment\n                });\n            } else if (resp.removedSvcs && resp.removedSvcs.length) {\n                fancyboxTools.openHandler('popupRemovedServicesWarning', false, {\n                    submitCallback: function submitCallback() {\n                        submitPaymentConfirm(removeInsuranceAeroexpress, email, phone);\n                    },\n                    closeCallback: function closeCallback() {\n                        backend.updateOrderServices(true);\n                    },\n\n                    removedSvcs: resp.removedSvcs,\n                    svcsToIssue: resp.svcsToIssue,\n                    noExtraServicesLeft: resp.noExtraServicesLeft,\n                    disableOutsideCloseClick: true\n                });\n            }\n\n            vm.confirmLoading = false;\n        }, function (resp) {\n            if (resp.error === 'web.noBookedConfirmedExtraServices') {\n                vm.fatalError = resp.error;\n            } else {\n                vm.confirmError = resp.error;\n            }\n\n            vm.confirmLoading = false;\n        });\n    }\n\n    function paymentFormChangeHandler() {\n        vm.showNeedSelectPaymentFormMesage = false;\n    }\n\n    function reloadPage() {\n        $window.location.reload();\n        return false;\n    }\n\n    function clearSession() {\n        backend.clearSession().then(function () {\n            redirect.goToSearchOrder();\n        });\n    }\n\n    function swithcSubmitButtonHoverState() {\n        vm.submitButtonHover = !vm.submitButtonHover;\n    }\n}]);\n\n},{}],3:[function(require,module,exports){\n\"use strict\";\n\"use strict\";\n\nangular.module('app').controller(\n    'SearchOrderScreenController',\n    ['$routeParams', 'backend', '$timeout', SearchOrderScreenController]\n);\n\nfunction SearchOrderScreenController($routeParams, backend, $timeout) {\n\n    var vm = this;\n    vm.loading = true;\n    vm.showSearchForm = true;\n    vm.searchParams = {};\n    vm.partiallyAddedPassengers = [];\n    vm.submitSearch = submitSearch;\n    vm.confirmHandler = confirmHandler;\n    vm.clear = clear;\n    vm.addPassenger = addPassenger;\n\n    backend.ready.then(function () {\n\n        angular.element('title').text(backend.getAliasWithPrefix('web.pageTitle.', 'searchOrder'));\n\n        vm.passengerLastNameRegexp = backend.applicationConstants.passengerLastNameRegexp;\n        vm.pnrOrTicketRegexp = backend.applicationConstants.pnrOrTicketRegexp;\n        vm.ticketRegexp = backend.applicationConstants.ticketRegexp;\n\n        if ($routeParams.pnrOrTicketNumber && $routeParams.lastName && backend.getParam('site.searchOrdersBy') === 'LAST_NAME_PNR_TICKET') {\n            vm.searchParams.pnrOrTicketNumber = $routeParams.pnrOrTicketNumber;\n            vm.searchParams.lastName = $routeParams.lastName;\n            vm.loading = false;\n            $timeout(submitSearch);\n        } else {\n            updateOrderInfoHandler();\n        }\n    });\n\n    function clear() {\n        backend.clearSession();\n        backend.clearOrderInfo();\n        vm.orderInfo = false;\n        vm.showSearchForm = true;\n        vm.partiallyAddedPassengers = [];\n    }\n\n    function submitSearch() {\n        vm.submitTouched = true;\n        if ((!backend.getParam('site.useSearchOrderAgreeCheckbox') || vm.searchOrderAgree) && vm.searchOrderForm.$valid) {\n            vm.searchLoading = true;\n            vm.errorMessage = false;\n            backend.searchOrderByParams(vm.searchParams, !!vm.partiallyAddedPassengers.length).then(function (resp) {\n                if (vm.searchParams.flight && vm.searchParams.date) {\n                    vm.searchParams = {\n                        flight: vm.searchParams.flight,\n                        date: vm.searchParams.date\n                    };\n                } else if (!resp.needToSpecifyDocument) {\n                    vm.searchParams = {};\n                }\n                vm.needToSpecifyDocument = resp.needToSpecifyDocument;\n                vm.showSearchForm = false;\n                vm.submitTouched = false;\n                if (resp.orderCompletelyInitialized) {\n                    vm.partiallyAddedPassengers = [];\n                    updateOrderInfoHandler();\n                } else {\n                    if (resp.partiallyAddedPassengers) {\n                        vm.partiallyAddedPassengers = resp.partiallyAddedPassengers;\n                    }\n                    if (vm.needToSpecifyDocument) {\n                        vm.showSearchForm = true;\n                    }\n                }\n                vm.searchLoading = false;\n            }, errorHandler);\n        }\n    }\n\n    function updateOrderInfoHandler() {\n        backend.updateOrderInfo().then(function (orderInfo) {\n            if (orderInfo.passengers) {\n                vm.orderInfo = orderInfo;\n                vm.showSearchForm = false;\n            }\n            vm.loading = false;\n        }, errorHandler);\n    }\n\n    function errorHandler(resp) {\n        vm.loading = false;\n        vm.searchLoading = false;\n        if (resp.error !== 'web.messages.emptyOrder') {\n            vm.errorMessage = resp.error;\n        }\n    }\n\n    function confirmHandler() {\n        backend.finishSeparatePassengersSearch().then(updateOrderInfoHandler, errorHandler);\n    }\n\n    function addPassenger() {\n        vm.showSearchForm = true;\n    }\n}\n\n},{}]},{},[1]);\n"]}